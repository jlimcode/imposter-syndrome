const socket=io();let landingPage=document.querySelector(".landing-container"),homePage=document.querySelector(".home-container");homePage.style.display="none";let gamePage=document.querySelector(".game-container");async function populateLocations(e){const t=document.querySelector(".game-location-container");let o=await fetch("/locations/"+e.toLowerCase()+".txt");(await o.text()).split("\n").forEach(e=>{let o=document.createElement("div");o.classList.add("game-location"),o.classList.add("location-unselected"),o.innerHTML=e,o.onclick=(()=>{o.classList.contains("location-unselected")?(o.classList.remove("location-unselected"),o.classList.add("location-selected")):(o.classList.remove("location-selected"),o.classList.add("location-unselected"))}),t.appendChild(o)})}function populatePlayers(e){let t=document.querySelector(".home-players");t.innerHTML="",e.forEach(e=>{let o=document.createElement("div");o.innerHTML=e,o.classList.add("home-player"),t.appendChild(o)})}gamePage.style.display="none",document.querySelector(".landing-form").onsubmit=(e=>{e.preventDefault();let t=document.querySelector(".landing-input");if(t.value)socket.emit("nickname",t.value),t.value="",landingPage.style.display="none",homePage.style.display="";else{let e=document.querySelector(".landing-instructions");e.innerHTML="Please enter a name.",e.style.color="red"}}),document.querySelector(".home-button").onclick=(async()=>{let e={location:document.querySelector(".home-select").value},t=await fetch("/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});console.log(await t.json())}),document.querySelector(".game-button").onclick=function(){if(this.classList.contains("game-button-clicked"))socket.disconnect(),window.location.href="/";else{let e=this.innerHTML;this.classList.add("game-button-clicked"),this.innerHTML="are you sure?",setTimeout(()=>{this.classList.remove("game-button-clicked"),this.innerHTML=e},3e3)}},socket.on("joined",function(e){console.log(e),""==gamePage.style.display&&(alert("The players in the game have changed, please restart"),socket.disconnect(),window.location.href="/"),populatePlayers(e)}),socket.on("start",function(e){homePage.style.display="none",gamePage.style.display="",populateLocations(e)}),socket.on("spymessage",function(e){console.log(e),document.querySelector(".game-spy-or-location").innerHTML="You are the spy"}),socket.on("secret-location",function(e){console.log(e),document.querySelector(".game-spy-or-location").innerHTML="The secret location is: "+e});